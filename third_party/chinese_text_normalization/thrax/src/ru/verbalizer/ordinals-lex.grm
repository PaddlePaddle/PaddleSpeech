# Copyright 2017 Google Inc.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# AUTOMATICALLY GENERATED: DO NOT EDIT.
import 'util/byte.grm' as b;

# Utilities for insertion and deletion.

func I[expr] {
  return "" : expr;
}

func D[expr] {
  return expr : "";
}

# Powers of base 10.
export POWERS =
    "[E15]"
  | "[E14]"
  | "[E13]"
  | "[E12]"
  | "[E11]"
  | "[E10]"
  | "[E9]"
  | "[E8]"
  | "[E7]"
  | "[E6]"
  | "[E5]"
  | "[E4]"
  | "[E3]"
  | "[E2]"
  | "[E1]"
;

export SIGMA = b.kBytes | POWERS;

export SIGMA_STAR = SIGMA*;

export SIGMA_PLUS = SIGMA+;

################################################################################
# BEGIN LANGUAGE SPECIFIC DATA
revaluations =
    ("[E4]" : "[E1]")
  | ("[E5]" : "[E2]")
  | ("[E7]" : "[E1]")
  | ("[E8]" : "[E2]")
;

Ms = "[E3]" | "[E6]" | "[E9]";


func Zero[expr] {
  return expr : ("");
}

space = " ";

lexset3 = Optimize[
    ("1[E1]+1" : "одиннадцатая@")
  | ("1[E1]+1" : "одиннадцати")
  | ("1[E1]+1" : "одиннадцатого@")
  | ("1[E1]+1" : "одиннадцатое@")
  | ("1[E1]+1" : "одиннадцатой@")
  | ("1[E1]+1" : "одиннадцатом@")
  | ("1[E1]+1" : "одиннадцатому@")
  | ("1[E1]+1" : "одиннадцатую@")
  | ("1[E1]+1" : "одиннадцатые@")
  | ("1[E1]+1" : "одиннадцатый@")
  | ("1[E1]+1" : "одиннадцатым@")
  | ("1[E1]+1" : "одиннадцатыми@")
  | ("1[E1]+1" : "одиннадцатых@")
  | ("1[E1]+1" : "одиннадцать")
  | ("1[E1]+1" : "одиннадцатью")
  | ("1[E1]+2" : "двенадцатая@")
  | ("1[E1]+2" : "двенадцати")
  | ("1[E1]+2" : "двенадцатого@")
  | ("1[E1]+2" : "двенадцатое@")
  | ("1[E1]+2" : "двенадцатой@")
  | ("1[E1]+2" : "двенадцатом@")
  | ("1[E1]+2" : "двенадцатому@")
  | ("1[E1]+2" : "двенадцатую@")
  | ("1[E1]+2" : "двенадцатые@")
  | ("1[E1]+2" : "двенадцатый@")
  | ("1[E1]+2" : "двенадцатым@")
  | ("1[E1]+2" : "двенадцатыми@")
  | ("1[E1]+2" : "двенадцатых@")
  | ("1[E1]+2" : "двенадцать")
  | ("1[E1]+2" : "двенадцатью")
  | ("1[E1]+3" : "тринадцатая@")
  | ("1[E1]+3" : "тринадцати")
  | ("1[E1]+3" : "тринадцатого@")
  | ("1[E1]+3" : "тринадцатое@")
  | ("1[E1]+3" : "тринадцатой@")
  | ("1[E1]+3" : "тринадцатом@")
  | ("1[E1]+3" : "тринадцатому@")
  | ("1[E1]+3" : "тринадцатую@")
  | ("1[E1]+3" : "тринадцатые@")
  | ("1[E1]+3" : "тринадцатый@")
  | ("1[E1]+3" : "тринадцатым@")
  | ("1[E1]+3" : "тринадцатыми@")
  | ("1[E1]+3" : "тринадцатых@")
  | ("1[E1]+3" : "тринадцать")
  | ("1[E1]+3" : "тринадцатью")
  | ("1[E1]+4" : "четырнадцатая@")
  | ("1[E1]+4" : "четырнадцати")
  | ("1[E1]+4" : "четырнадцатого@")
  | ("1[E1]+4" : "четырнадцатое@")
  | ("1[E1]+4" : "четырнадцатой@")
  | ("1[E1]+4" : "четырнадцатом@")
  | ("1[E1]+4" : "четырнадцатому@")
  | ("1[E1]+4" : "четырнадцатую@")
  | ("1[E1]+4" : "четырнадцатые@")
  | ("1[E1]+4" : "четырнадцатый@")
  | ("1[E1]+4" : "четырнадцатым@")
  | ("1[E1]+4" : "четырнадцатыми@")
  | ("1[E1]+4" : "четырнадцатых@")
  | ("1[E1]+4" : "четырнадцать")
  | ("1[E1]+4" : "четырнадцатью")
  | ("1[E1]+5" : "пятнадцатая@")
  | ("1[E1]+5" : "пятнадцати")
  | ("1[E1]+5" : "пятнадцатого@")
  | ("1[E1]+5" : "пятнадцатое@")
  | ("1[E1]+5" : "пятнадцатой@")
  | ("1[E1]+5" : "пятнадцатом@")
  | ("1[E1]+5" : "пятнадцатому@")
  | ("1[E1]+5" : "пятнадцатую@")
  | ("1[E1]+5" : "пятнадцатые@")
  | ("1[E1]+5" : "пятнадцатый@")
  | ("1[E1]+5" : "пятнадцатым@")
  | ("1[E1]+5" : "пятнадцатыми@")
  | ("1[E1]+5" : "пятнадцатых@")
  | ("1[E1]+5" : "пятнадцать")
  | ("1[E1]+5" : "пятнадцатью")
  | ("1[E1]+6" : "шестнадцатая@")
  | ("1[E1]+6" : "шестнадцати")
  | ("1[E1]+6" : "шестнадцатого@")
  | ("1[E1]+6" : "шестнадцатое@")
  | ("1[E1]+6" : "шестнадцатой@")
  | ("1[E1]+6" : "шестнадцатом@")
  | ("1[E1]+6" : "шестнадцатому@")
  | ("1[E1]+6" : "шестнадцатую@")
  | ("1[E1]+6" : "шестнадцатые@")
  | ("1[E1]+6" : "шестнадцатый@")
  | ("1[E1]+6" : "шестнадцатым@")
  | ("1[E1]+6" : "шестнадцатыми@")
  | ("1[E1]+6" : "шестнадцатых@")
  | ("1[E1]+6" : "шестнадцать")
  | ("1[E1]+6" : "шестнадцатью")
  | ("1[E1]+7" : "семнадцатая@")
  | ("1[E1]+7" : "семнадцати")
  | ("1[E1]+7" : "семнадцатого@")
  | ("1[E1]+7" : "семнадцатое@")
  | ("1[E1]+7" : "семнадцатой@")
  | ("1[E1]+7" : "семнадцатом@")
  | ("1[E1]+7" : "семнадцатому@")
  | ("1[E1]+7" : "семнадцатую@")
  | ("1[E1]+7" : "семнадцатые@")
  | ("1[E1]+7" : "семнадцатый@")
  | ("1[E1]+7" : "семнадцатым@")
  | ("1[E1]+7" : "семнадцатыми@")
  | ("1[E1]+7" : "семнадцатых@")
  | ("1[E1]+7" : "семнадцать")
  | ("1[E1]+7" : "семнадцатью")
  | ("1[E1]+8" : "восемнадцатая@")
  | ("1[E1]+8" : "восемнадцати")
  | ("1[E1]+8" : "восемнадцатого@")
  | ("1[E1]+8" : "восемнадцатое@")
  | ("1[E1]+8" : "восемнадцатой@")
  | ("1[E1]+8" : "восемнадцатом@")
  | ("1[E1]+8" : "восемнадцатому@")
  | ("1[E1]+8" : "восемнадцатую@")
  | ("1[E1]+8" : "восемнадцатые@")
  | ("1[E1]+8" : "восемнадцатый@")
  | ("1[E1]+8" : "восемнадцатым@")
  | ("1[E1]+8" : "восемнадцатыми@")
  | ("1[E1]+8" : "восемнадцатых@")
  | ("1[E1]+8" : "восемнадцать")
  | ("1[E1]+8" : "восемнадцатью")
  | ("1[E1]+9" : "девятнадцатая@")
  | ("1[E1]+9" : "девятнадцати")
  | ("1[E1]+9" : "девятнадцатого@")
  | ("1[E1]+9" : "девятнадцатое@")
  | ("1[E1]+9" : "девятнадцатой@")
  | ("1[E1]+9" : "девятнадцатом@")
  | ("1[E1]+9" : "девятнадцатому@")
  | ("1[E1]+9" : "девятнадцатую@")
  | ("1[E1]+9" : "девятнадцатые@")
  | ("1[E1]+9" : "девятнадцатый@")
  | ("1[E1]+9" : "девятнадцатым@")
  | ("1[E1]+9" : "девятнадцатыми@")
  | ("1[E1]+9" : "девятнадцатых@")
  | ("1[E1]+9" : "девятнадцать")
  | ("1[E1]+9" : "девятнадцатью")]
;

lex3 = CDRewrite[lexset3 I[space], "", "", SIGMA_STAR];

lexset2 = Optimize[
    ("1[E1]" : "десятая@")
  | ("1[E1]" : "десяти")
  | ("1[E1]" : "десятого@")
  | ("1[E1]" : "десятое@")
  | ("1[E1]" : "десятой@")
  | ("1[E1]" : "десятом@")
  | ("1[E1]" : "десятому@")
  | ("1[E1]" : "десятую@")
  | ("1[E1]" : "десятые@")
  | ("1[E1]" : "десятый@")
  | ("1[E1]" : "десятым@")
  | ("1[E1]" : "десятыми@")
  | ("1[E1]" : "десятых@")
  | ("1[E1]" : "десять")
  | ("1[E1]" : "десятью")
  | ("1[E2]" : "сотая@")
  | ("1[E2]" : "сотого@")
  | ("1[E2]" : "сотое@")
  | ("1[E2]" : "сотой@")
  | ("1[E2]" : "сотом@")
  | ("1[E2]" : "сотому@")
  | ("1[E2]" : "сотую@")
  | ("1[E2]" : "сотые@")
  | ("1[E2]" : "сотый@")
  | ("1[E2]" : "сотым@")
  | ("1[E2]" : "сотыми@")
  | ("1[E2]" : "сотых@")
  | ("1[E2]" : "ста")
  | ("1[E2]" : "сто")
  | ("1[E3]" : "тысячная@")
  | ("1[E3]" : "тысячного@")
  | ("1[E3]" : "тысячное@")
  | ("1[E3]" : "тысячной@")
  | ("1[E3]" : "тысячном@")
  | ("1[E3]" : "тысячному@")
  | ("1[E3]" : "тысячную@")
  | ("1[E3]" : "тысячные@")
  | ("1[E3]" : "тысячный@")
  | ("1[E3]" : "тысячным@")
  | ("1[E3]" : "тысячными@")
  | ("1[E3]" : "тысячных@")
  | ("1[E6]" : "миллионная@")
  | ("1[E6]" : "миллионного@")
  | ("1[E6]" : "миллионное@")
  | ("1[E6]" : "миллионной@")
  | ("1[E6]" : "миллионном@")
  | ("1[E6]" : "миллионному@")
  | ("1[E6]" : "миллионную@")
  | ("1[E6]" : "миллионные@")
  | ("1[E6]" : "миллионный@")
  | ("1[E6]" : "миллионным@")
  | ("1[E6]" : "миллионными@")
  | ("1[E6]" : "миллионных@")
  | ("1[E9]" : "миллиардная@")
  | ("1[E9]" : "миллиардного@")
  | ("1[E9]" : "миллиардное@")
  | ("1[E9]" : "миллиардной@")
  | ("1[E9]" : "миллиардном@")
  | ("1[E9]" : "миллиардному@")
  | ("1[E9]" : "миллиардную@")
  | ("1[E9]" : "миллиардные@")
  | ("1[E9]" : "миллиардный@")
  | ("1[E9]" : "миллиардным@")
  | ("1[E9]" : "миллиардными@")
  | ("1[E9]" : "миллиардных@")
  | ("2[E1]" : "двадцатая@")
  | ("2[E1]" : "двадцати")
  | ("2[E1]" : "двадцатого@")
  | ("2[E1]" : "двадцатое@")
  | ("2[E1]" : "двадцатой@")
  | ("2[E1]" : "двадцатом@")
  | ("2[E1]" : "двадцатому@")
  | ("2[E1]" : "двадцатую@")
  | ("2[E1]" : "двадцатые@")
  | ("2[E1]" : "двадцатый@")
  | ("2[E1]" : "двадцатым@")
  | ("2[E1]" : "двадцатыми@")
  | ("2[E1]" : "двадцатых@")
  | ("2[E1]" : "двадцать")
  | ("2[E1]" : "двадцатью")
  | ("2[E2]" : "двести")
  | ("2[E2]" : "двумстам")
  | ("2[E2]" : "двумястами")
  | ("2[E2]" : "двухсот")
  | ("2[E2]" : "двухсотая@")
  | ("2[E2]" : "двухсотого@")
  | ("2[E2]" : "двухсотое@")
  | ("2[E2]" : "двухсотой@")
  | ("2[E2]" : "двухсотом@")
  | ("2[E2]" : "двухсотому@")
  | ("2[E2]" : "двухсотую@")
  | ("2[E2]" : "двухсотые@")
  | ("2[E2]" : "двухсотый@")
  | ("2[E2]" : "двухсотым@")
  | ("2[E2]" : "двухсотыми@")
  | ("2[E2]" : "двухсотых@")
  | ("2[E2]" : "двухстах")
  | ("3[E1]" : "тридцатая@")
  | ("3[E1]" : "тридцати")
  | ("3[E1]" : "тридцатого@")
  | ("3[E1]" : "тридцатое@")
  | ("3[E1]" : "тридцатой@")
  | ("3[E1]" : "тридцатом@")
  | ("3[E1]" : "тридцатому@")
  | ("3[E1]" : "тридцатую@")
  | ("3[E1]" : "тридцатые@")
  | ("3[E1]" : "тридцатый@")
  | ("3[E1]" : "тридцатым@")
  | ("3[E1]" : "тридцатыми@")
  | ("3[E1]" : "тридцатых@")
  | ("3[E1]" : "тридцать")
  | ("3[E1]" : "тридцатью")
  | ("3[E2]" : "тремстам")
  | ("3[E2]" : "тремястами")
  | ("3[E2]" : "трехсот")
  | ("3[E2]" : "трехсотая@")
  | ("3[E2]" : "трехсотого@")
  | ("3[E2]" : "трехсотое@")
  | ("3[E2]" : "трехсотой@")
  | ("3[E2]" : "трехсотом@")
  | ("3[E2]" : "трехсотому@")
  | ("3[E2]" : "трехсотую@")
  | ("3[E2]" : "трехсотые@")
  | ("3[E2]" : "трехсотый@")
  | ("3[E2]" : "трехсотым@")
  | ("3[E2]" : "трехсотыми@")
  | ("3[E2]" : "трехсотых@")
  | ("3[E2]" : "трехстах")
  | ("3[E2]" : "триста")
  | ("4[E1]" : "сорок")
  | ("4[E1]" : "сорока")
  | ("4[E1]" : "сороковая@")
  | ("4[E1]" : "сорокового@")
  | ("4[E1]" : "сороковое@")
  | ("4[E1]" : "сороковой@")
  | ("4[E1]" : "сороковом@")
  | ("4[E1]" : "сороковому@")
  | ("4[E1]" : "сороковую@")
  | ("4[E1]" : "сороковые@")
  | ("4[E1]" : "сороковым@")
  | ("4[E1]" : "сороковыми@")
  | ("4[E1]" : "сороковых@")
  | ("4[E2]" : "четыремстам")
  | ("4[E2]" : "четыреста")
  | ("4[E2]" : "четырехсот")
  | ("4[E2]" : "четырехсотая@")
  | ("4[E2]" : "четырехсотого@")
  | ("4[E2]" : "четырехсотое@")
  | ("4[E2]" : "четырехсотой@")
  | ("4[E2]" : "четырехсотом@")
  | ("4[E2]" : "четырехсотому@")
  | ("4[E2]" : "четырехсотую@")
  | ("4[E2]" : "четырехсотые@")
  | ("4[E2]" : "четырехсотый@")
  | ("4[E2]" : "четырехсотым@")
  | ("4[E2]" : "четырехсотыми@")
  | ("4[E2]" : "четырехсотых@")
  | ("4[E2]" : "четырехстах")
  | ("4[E2]" : "четырьмястами")
  | ("5[E1]" : "пятидесятая@")
  | ("5[E1]" : "пятидесяти")
  | ("5[E1]" : "пятидесятого@")
  | ("5[E1]" : "пятидесятое@")
  | ("5[E1]" : "пятидесятой@")
  | ("5[E1]" : "пятидесятом@")
  | ("5[E1]" : "пятидесятому@")
  | ("5[E1]" : "пятидесятую@")
  | ("5[E1]" : "пятидесятые@")
  | ("5[E1]" : "пятидесятый@")
  | ("5[E1]" : "пятидесятым@")
  | ("5[E1]" : "пятидесятыми@")
  | ("5[E1]" : "пятидесятых@")
  | ("5[E1]" : "пятьдесят")
  | ("5[E1]" : "пятьюдесятью")
  | ("5[E2]" : "пятисот")
  | ("5[E2]" : "пятисотая@")
  | ("5[E2]" : "пятисотого@")
  | ("5[E2]" : "пятисотое@")
  | ("5[E2]" : "пятисотой@")
  | ("5[E2]" : "пятисотом@")
  | ("5[E2]" : "пятисотому@")
  | ("5[E2]" : "пятисотую@")
  | ("5[E2]" : "пятисотые@")
  | ("5[E2]" : "пятисотый@")
  | ("5[E2]" : "пятисотым@")
  | ("5[E2]" : "пятисотыми@")
  | ("5[E2]" : "пятисотых@")
  | ("5[E2]" : "пятистам")
  | ("5[E2]" : "пятистах")
  | ("5[E2]" : "пятьсот")
  | ("5[E2]" : "пятьюстами")
  | ("6[E1]" : "шестидесятая@")
  | ("6[E1]" : "шестидесяти")
  | ("6[E1]" : "шестидесятого@")
  | ("6[E1]" : "шестидесятое@")
  | ("6[E1]" : "шестидесятой@")
  | ("6[E1]" : "шестидесятом@")
  | ("6[E1]" : "шестидесятому@")
  | ("6[E1]" : "шестидесятую@")
  | ("6[E1]" : "шестидесятые@")
  | ("6[E1]" : "шестидесятый@")
  | ("6[E1]" : "шестидесятым@")
  | ("6[E1]" : "шестидесятыми@")
  | ("6[E1]" : "шестидесятых@")
  | ("6[E1]" : "шестьдесят")
  | ("6[E1]" : "шестьюдесятью")
  | ("6[E2]" : "шестисот")
  | ("6[E2]" : "шестисотая@")
  | ("6[E2]" : "шестисотого@")
  | ("6[E2]" : "шестисотое@")
  | ("6[E2]" : "шестисотой@")
  | ("6[E2]" : "шестисотом@")
  | ("6[E2]" : "шестисотому@")
  | ("6[E2]" : "шестисотую@")
  | ("6[E2]" : "шестисотые@")
  | ("6[E2]" : "шестисотый@")
  | ("6[E2]" : "шестисотым@")
  | ("6[E2]" : "шестисотыми@")
  | ("6[E2]" : "шестисотых@")
  | ("6[E2]" : "шестистам")
  | ("6[E2]" : "шестистах")
  | ("6[E2]" : "шестьсот")
  | ("6[E2]" : "шестьюстами")
  | ("7[E1]" : "семидесятая@")
  | ("7[E1]" : "семидесяти")
  | ("7[E1]" : "семидесятого@")
  | ("7[E1]" : "семидесятое@")
  | ("7[E1]" : "семидесятой@")
  | ("7[E1]" : "семидесятом@")
  | ("7[E1]" : "семидесятому@")
  | ("7[E1]" : "семидесятую@")
  | ("7[E1]" : "семидесятые@")
  | ("7[E1]" : "семидесятый@")
  | ("7[E1]" : "семидесятым@")
  | ("7[E1]" : "семидесятыми@")
  | ("7[E1]" : "семидесятых@")
  | ("7[E1]" : "семьдесят")
  | ("7[E1]" : "семьюдесятью")
  | ("7[E2]" : "семисот")
  | ("7[E2]" : "семисотая@")
  | ("7[E2]" : "семисотого@")
  | ("7[E2]" : "семисотое@")
  | ("7[E2]" : "семисотой@")
  | ("7[E2]" : "семисотом@")
  | ("7[E2]" : "семисотому@")
  | ("7[E2]" : "семисотую@")
  | ("7[E2]" : "семисотые@")
  | ("7[E2]" : "семисотый@")
  | ("7[E2]" : "семисотым@")
  | ("7[E2]" : "семисотыми@")
  | ("7[E2]" : "семисотых@")
  | ("7[E2]" : "семистам")
  | ("7[E2]" : "семистах")
  | ("7[E2]" : "семьсот")
  | ("7[E2]" : "семьюстами")
  | ("8[E1]" : "восемьдесят")
  | ("8[E1]" : "восьмидесятая@")
  | ("8[E1]" : "восьмидесяти")
  | ("8[E1]" : "восьмидесятого@")
  | ("8[E1]" : "восьмидесятое@")
  | ("8[E1]" : "восьмидесятой@")
  | ("8[E1]" : "восьмидесятом@")
  | ("8[E1]" : "восьмидесятому@")
  | ("8[E1]" : "восьмидесятую@")
  | ("8[E1]" : "восьмидесятые@")
  | ("8[E1]" : "восьмидесятый@")
  | ("8[E1]" : "восьмидесятым@")
  | ("8[E1]" : "восьмидесятыми@")
  | ("8[E1]" : "восьмидесятых@")
  | ("8[E1]" : "восьмьюдесятью")
  | ("8[E2]" : "восемьсот")
  | ("8[E2]" : "восемьюстами")
  | ("8[E2]" : "восьмисот")
  | ("8[E2]" : "восьмисотая@")
  | ("8[E2]" : "восьмисотого@")
  | ("8[E2]" : "восьмисотое@")
  | ("8[E2]" : "восьмисотой@")
  | ("8[E2]" : "восьмисотом@")
  | ("8[E2]" : "восьмисотому@")
  | ("8[E2]" : "восьмисотую@")
  | ("8[E2]" : "восьмисотые@")
  | ("8[E2]" : "восьмисотый@")
  | ("8[E2]" : "восьмисотым@")
  | ("8[E2]" : "восьмисотыми@")
  | ("8[E2]" : "восьмисотых@")
  | ("8[E2]" : "восьмистам")
  | ("8[E2]" : "восьмистах")
  | ("8[E2]" : "восьмьюстами")
  | ("9[E1]" : "девяноста")
  | ("9[E1]" : "девяностая@")
  | ("9[E1]" : "девяносто")
  | ("9[E1]" : "девяностого@")
  | ("9[E1]" : "девяностое@")
  | ("9[E1]" : "девяностой@")
  | ("9[E1]" : "девяностом@")
  | ("9[E1]" : "девяностому@")
  | ("9[E1]" : "девяностую@")
  | ("9[E1]" : "девяностые@")
  | ("9[E1]" : "девяностый@")
  | ("9[E1]" : "девяностым@")
  | ("9[E1]" : "девяностыми@")
  | ("9[E1]" : "девяностых@")
  | ("9[E2]" : "девятисот")
  | ("9[E2]" : "девятисотая@")
  | ("9[E2]" : "девятисотого@")
  | ("9[E2]" : "девятисотое@")
  | ("9[E2]" : "девятисотой@")
  | ("9[E2]" : "девятисотом@")
  | ("9[E2]" : "девятисотому@")
  | ("9[E2]" : "девятисотую@")
  | ("9[E2]" : "девятисотые@")
  | ("9[E2]" : "девятисотый@")
  | ("9[E2]" : "девятисотым@")
  | ("9[E2]" : "девятисотыми@")
  | ("9[E2]" : "девятисотых@")
  | ("9[E2]" : "девятистам")
  | ("9[E2]" : "девятистах")
  | ("9[E2]" : "девятьсот")
  | ("9[E2]" : "девятьюстами")]
;

lex2 = CDRewrite[lexset2 I[space], "", "", SIGMA_STAR];

lexset1 = Optimize[
    ("+" : "")
  | ("1" : "один")
  | ("1" : "одна")
  | ("1" : "одни")
  | ("1" : "одним")
  | ("1" : "одними")
  | ("1" : "одних")
  | ("1" : "одно")
  | ("1" : "одного")
  | ("1" : "одной")
  | ("1" : "одном")
  | ("1" : "одному")
  | ("1" : "одною")
  | ("1" : "одну")
  | ("1" : "первая@")
  | ("1" : "первого@")
  | ("1" : "первое@")
  | ("1" : "первой@")
  | ("1" : "первом@")
  | ("1" : "первому@")
  | ("1" : "первую@")
  | ("1" : "первые@")
  | ("1" : "первый@")
  | ("1" : "первым@")
  | ("1" : "первыми@")
  | ("1" : "первых@")
  | ("2" : "вторая@")
  | ("2" : "второго@")
  | ("2" : "второе@")
  | ("2" : "второй@")
  | ("2" : "втором@")
  | ("2" : "второму@")
  | ("2" : "вторую@")
  | ("2" : "вторые@")
  | ("2" : "вторым@")
  | ("2" : "вторыми@")
  | ("2" : "вторых@")
  | ("2" : "два")
  | ("2" : "две")
  | ("2" : "двум")
  | ("2" : "двумя")
  | ("2" : "двух")
  | ("3" : "трем")
  | ("3" : "тремя")
  | ("3" : "третий@")
  | ("3" : "третье@")
  | ("3" : "третьего@")
  | ("3" : "третьей@")
  | ("3" : "третьем@")
  | ("3" : "третьему@")
  | ("3" : "третьи@")
  | ("3" : "третьим@")
  | ("3" : "третьими@")
  | ("3" : "третьих@")
  | ("3" : "третью@")
  | ("3" : "третья@")
  | ("3" : "трех")
  | ("3" : "три")
  | ("4" : "четвертая@")
  | ("4" : "четвертого@")
  | ("4" : "четвертое@")
  | ("4" : "четвертой@")
  | ("4" : "четвертом@")
  | ("4" : "четвертому@")
  | ("4" : "четвертую@")
  | ("4" : "четвертые@")
  | ("4" : "четвертый@")
  | ("4" : "четвертым@")
  | ("4" : "четвертыми@")
  | ("4" : "четвертых@")
  | ("4" : "четыре")
  | ("4" : "четырем")
  | ("4" : "четырех")
  | ("4" : "четырьмя")
  | ("5" : "пятая@")
  | ("5" : "пяти")
  | ("5" : "пятого@")
  | ("5" : "пятое@")
  | ("5" : "пятой@")
  | ("5" : "пятом@")
  | ("5" : "пятому@")
  | ("5" : "пятую@")
  | ("5" : "пятые@")
  | ("5" : "пятый@")
  | ("5" : "пятым@")
  | ("5" : "пятыми@")
  | ("5" : "пятых@")
  | ("5" : "пять")
  | ("5" : "пятью")
  | ("6" : "шестая@")
  | ("6" : "шести")
  | ("6" : "шестого@")
  | ("6" : "шестое@")
  | ("6" : "шестой@")
  | ("6" : "шестом@")
  | ("6" : "шестому@")
  | ("6" : "шестую@")
  | ("6" : "шестые@")
  | ("6" : "шестым@")
  | ("6" : "шестыми@")
  | ("6" : "шестых@")
  | ("6" : "шесть")
  | ("6" : "шестью")
  | ("7" : "седьмая@")
  | ("7" : "седьмого@")
  | ("7" : "седьмое@")
  | ("7" : "седьмой@")
  | ("7" : "седьмом@")
  | ("7" : "седьмому@")
  | ("7" : "седьмую@")
  | ("7" : "седьмые@")
  | ("7" : "седьмым@")
  | ("7" : "седьмыми@")
  | ("7" : "седьмых@")
  | ("7" : "семи")
  | ("7" : "семь")
  | ("7" : "семью")
  | ("8" : "восемь")
  | ("8" : "восьмая@")
  | ("8" : "восьми")
  | ("8" : "восьмого@")
  | ("8" : "восьмое@")
  | ("8" : "восьмой@")
  | ("8" : "восьмом@")
  | ("8" : "восьмому@")
  | ("8" : "восьмую@")
  | ("8" : "восьмые@")
  | ("8" : "восьмым@")
  | ("8" : "восьмыми@")
  | ("8" : "восьмых@")
  | ("8" : "восьмью")
  | ("9" : "девятая@")
  | ("9" : "девяти")
  | ("9" : "девятого@")
  | ("9" : "девятое@")
  | ("9" : "девятой@")
  | ("9" : "девятом@")
  | ("9" : "девятому@")
  | ("9" : "девятую@")
  | ("9" : "девятые@")
  | ("9" : "девятый@")
  | ("9" : "девятым@")
  | ("9" : "девятыми@")
  | ("9" : "девятых@")
  | ("9" : "девять")
  | ("9" : "девятью")
  | ("[E3]" : "тысяч")
  | ("[E3]" : "тысяча")
  | ("[E3]" : "тысячам")
  | ("[E3]" : "тысячами")
  | ("[E3]" : "тысячах")
  | ("[E3]" : "тысяче")
  | ("[E3]" : "тысячей")
  | ("[E3]" : "тысячи")
  | ("[E3]" : "тысячу")
  | ("[E3]" : "тысячью")
  | ("[E6]" : "миллион")
  | ("[E6]" : "миллиона")
  | ("[E6]" : "миллионам")
  | ("[E6]" : "миллионами")
  | ("[E6]" : "миллионах")
  | ("[E6]" : "миллионе")
  | ("[E6]" : "миллионов")
  | ("[E6]" : "миллионом")
  | ("[E6]" : "миллиону")
  | ("[E6]" : "миллионы")
  | ("[E9]" : "миллиард")
  | ("[E9]" : "миллиарда")
  | ("[E9]" : "миллиардам")
  | ("[E9]" : "миллиардами")
  | ("[E9]" : "миллиардах")
  | ("[E9]" : "миллиарде")
  | ("[E9]" : "миллиардов")
  | ("[E9]" : "миллиардом")
  | ("[E9]" : "миллиарду")
  | ("[E9]" : "миллиарды")
  | ("|0|" : "ноле")
  | ("|0|" : "нолем")
  | ("|0|" : "ноль")
  | ("|0|" : "нолю")
  | ("|0|" : "ноля")
  | ("|0|" : "нуле")
  | ("|0|" : "нулем")
  | ("|0|" : "нуль")
  | ("|0|" : "нулю")
  | ("|0|" : "нуля")]
;

lex1 = CDRewrite[lexset1 I[space], "", "", SIGMA_STAR];

export LEX = Optimize[lex3 @ lex2 @ lex1];

export INDEPENDENT_EXPONENTS = "[E3]" | "[E6]" | "[E9]";

# END LANGUAGE SPECIFIC DATA
################################################################################
# Inserts a marker after the Ms.
export INSERT_BOUNDARY = CDRewrite["" : "%", Ms, "", SIGMA_STAR];

# Deletes all powers and "+".
export DELETE_POWERS = CDRewrite[D[POWERS | "+"], "", "", SIGMA_STAR];

# Deletes trailing zeros at the beginning of a number, so that "0003" does not
# get treated as an ordinary number.
export DELETE_INITIAL_ZEROS =
  CDRewrite[("0" POWERS "+") : "", "[BOS]", "", SIGMA_STAR]
;

NonMs = Optimize[POWERS - Ms];

# Deletes (usually) zeros before a non-M. E.g., +0[E1] should be
# deleted
export DELETE_INTERMEDIATE_ZEROS1 =
  CDRewrite[Zero["+0" NonMs], "", "", SIGMA_STAR]
;

# Deletes (usually) zeros before an M, if there is no non-zero element between
# that and the previous boundary. Thus, if after the result of the rule above we
# end up with "%+0[E3]", then that gets deleted. Also (really) deletes a final
# zero.
export DELETE_INTERMEDIATE_ZEROS2 = Optimize[
   CDRewrite[Zero["%+0" Ms], "", "", SIGMA_STAR]
 @ CDRewrite[D["+0"], "", "[EOS]", SIGMA_STAR]]
;

# Final clean up of stray zeros.
export DELETE_REMAINING_ZEROS = Optimize[
   CDRewrite[Zero["+0"], "", "", SIGMA_STAR]
 @ CDRewrite[Zero["0"], "", "", SIGMA_STAR]]
;

# Applies the revaluation map. For example in English, change [E4] to [E1] as a
# modifier of [E3]
export REVALUE = CDRewrite[revaluations, "", "", SIGMA_STAR];

# Deletes the various marks and powers in the input and output.
export DELETE_MARKS = CDRewrite[D["%" | "+" | POWERS], "", "", SIGMA_STAR];

export CLEAN_SPACES = Optimize[
   CDRewrite[" "+ : " ", b.kNotSpace, b.kNotSpace, SIGMA_STAR]
 @ CDRewrite[" "* : "", "[BOS]", "", SIGMA_STAR]
 @ CDRewrite[" "* : "", "", "[EOS]", SIGMA_STAR]]
;

d = b.kDigit;

# Germanic inversion rule.
germanic =
    (I["1+"] d "[E1]" D["+1"])
  | (I["2+"] d "[E1]" D["+2"])
  | (I["3+"] d "[E1]" D["+3"])
  | (I["4+"] d "[E1]" D["+4"])
  | (I["5+"] d "[E1]" D["+5"])
  | (I["6+"] d "[E1]" D["+6"])
  | (I["7+"] d "[E1]" D["+7"])
  | (I["8+"] d "[E1]" D["+8"])
  | (I["9+"] d "[E1]" D["+9"])
;

germanic_inversion =
  CDRewrite[germanic, "", "", SIGMA_STAR, 'ltr', 'opt']
;

export GERMANIC_INVERSION = SIGMA_STAR;
export ORDINAL_RESTRICTION = 
  Optimize[((SIGMA - "@")* "@") @ CDRewrite[D["@"], "", "", SIGMA_STAR]]
;
nondigits = b.kBytes - b.kDigit;
export ORDINAL_SUFFIX = D[nondigits*];
